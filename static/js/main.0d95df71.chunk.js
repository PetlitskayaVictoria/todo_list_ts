(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{103:function(t,e,a){},104:function(t,e,a){},128:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),o=a(8),r=a.n(o);a(103),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(104);var c,l,s=a(170),u=a(171),d=a(172),f=a(164),m=a(167),p=a(174),b=a(175),g=a(173),E=a(11),h=a(21),y=a(80),v=a.n(y).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"9fa0e134-93f8-4f6c-b99f-9c479847d776"}}),C=function(t,e){return v.put("todo-lists/".concat(t),{title:e})},k=function(){return v.get("todo-lists")},I=function(t){return v.post("todo-lists",{title:t})},j=function(t){return v.delete("todo-lists/".concat(t))},O=function(t,e,a){return v.put("todo-lists/".concat(t,"/tasks/").concat(e),a)},L=function(t){return v.get("todo-lists/".concat(t,"/tasks"))},A=function(t,e){return v.post("todo-lists/".concat(t,"/tasks"),{title:e})},w=function(t,e){return v.delete("todo-lists/".concat(t,"/tasks/").concat(e))},S=function(t){return v.post("auth/login",t)},T=function(){return v.get("auth/me")},x=function(){return v.delete("auth/login")};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.High=2]="High",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(l||(l={}));var P=function(t,e){t.messages.length?e(U({error:t.messages[0]})):e(U({error:"Some error occurred"})),e(B({status:"failed"}))},z=function(t,e){e(U({error:t.message})),e(B({status:"failed"}))},F=a(26),N=Object(F.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),D=N.reducer,M=N.actions.setIsLoggedInAC,V=Object(F.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(t,e){t.status=e.payload.status},setAppErrorAC:function(t,e){t.error=e.payload.error},setIsInitialized:function(t,e){t.isInitialized=e.payload.isInitialized}}}),R=V.reducer,q=V.actions,B=q.setAppStatusAC,U=q.setAppErrorAC,_=q.setIsInitialized,H=Object(F.b)({name:"todolists",initialState:[],reducers:{removeTodolistAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistId}));a>-1&&t.splice(a,1)},addTodolistAC:function(t,e){t.unshift(Object(h.a)(Object(h.a)({},e.payload.todoList),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].title=e.payload.title},changeFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].filter=e.payload.newValue},setTodoListsAC:function(t,e){return e.payload.todoLists.map((function(t){return Object(h.a)(Object(h.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},changeTodolistEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].entityStatus=e.payload.entityStatus}}}),K=H.reducer,Z=H.actions,J=Z.removeTodolistAC,W=Z.addTodolistAC,$=Z.changeTodolistTitleAC,G=Z.changeFilterAC,Y=Z.setTodoListsAC,Q=Z.changeTodolistEntityStatusAC,X=Object(F.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&a.splice(n,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(Object(h.a)(Object(h.a)({},e.payload.task),{},{entityStatus:"idle"}))},updateTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(h.a)(Object(h.a)({},a[n]),e.payload.domainModel))},setTasksAC:function(t,e){t[e.payload.todoListId]=e.payload.tasks.map((function(t){return Object(h.a)(Object(h.a)({},t),{},{entityStatus:"idle"})}))},changeTaskEntityStatusAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n].entityStatus=e.payload.entityStatus)}},extraReducers:function(t){t.addCase(W,(function(t,e){t[e.payload.todoList.id]=[]})),t.addCase(J,(function(t,e){delete t[e.payload.todolistId]})),t.addCase(Y,(function(t,e){e.payload.todoLists.forEach((function(e){return t[e.id]=[]}))}))}}),tt=X.reducer,et=X.actions,at=et.removeTaskAC,nt=et.addTaskAC,it=et.updateTaskAC,ot=et.setTasksAC,rt=et.changeTaskEntityStatusAC,ct=function(t,e){return function(a){a(B({status:"loading"})),a(rt({taskId:e,todoListId:t,entityStatus:"loading"})),w(t,e).then((function(n){0===n.data.resultCode?(a(at({taskId:e,todoListId:t})),a(B({status:"succeeded"}))):P(n.data,a)})).catch((function(t){z(t,a)}))}},lt=function(t,e,a){return function(n,i){var o=i().tasks[t].find((function(t){return t.id===e}));if(o){var r=Object(h.a)({title:o.title,description:o.description,status:o.status,priority:o.priority,startDate:o.startDate,deadline:o.deadline},a);n(B({status:"loading"})),n(rt({taskId:e,todoListId:t,entityStatus:"loading"})),O(t,e,r).then((function(i){0===i.data.resultCode?n(it({taskId:e,domainModel:a,todoListId:t})):P(i.data,n)})).catch((function(t){z(t,n)})).finally((function(){n(B({status:"succeeded"})),n(rt({taskId:e,todoListId:t,entityStatus:"succeeded"}))}))}}},st=a(168),ut=a(129),dt=a(43),ft=a(176),mt=a(165),pt=i.a.memo((function(t){var e=Object(n.useState)(null),a=Object(dt.a)(e,2),o=a[0],r=a[1],c=Object(n.useState)(""),l=Object(dt.a)(c,2),s=l[0],u=l[1],d=function(){s.trim()?(t.createItem(s),u("")):(u(""),r("Name is required"))};return i.a.createElement("div",null,i.a.createElement(ft.a,{variant:"outlined",value:s,onChange:function(t){u(t.currentTarget.value)},onKeyPress:function(t){null!==o&&r(null),"Enter"===t.key&&d()},onBlur:function(){r(null)},helperText:o?"Name is required":"",label:"Title",error:!!o,disabled:t.disabled}),i.a.createElement(f.a,{onClick:d},i.a.createElement(mt.a,null)))})),bt=i.a.memo((function(t){var e=Object(n.useState)(!1),a=Object(dt.a)(e,2),o=a[0],r=a[1],c=Object(n.useState)(t.title),l=Object(dt.a)(c,2),s=l[0],u=l[1],d=function(){t.changeTitle(s),r(!1)};return o&&!t.disabled?i.a.createElement(ft.a,{value:s,onChange:function(t){u(t.currentTarget.value)},onBlur:d,autoFocus:!0,onKeyPress:function(t){"Enter"===t.key&&d()}}):i.a.createElement("span",{onDoubleClick:function(){r(!0)}},t.title)})),gt=a(166),Et=a(178),ht=i.a.memo((function(t){var e=Object(E.b)(),a=Object(n.useCallback)((function(a){var n=a.currentTarget.checked?c.Completed:c.New;e(lt(t.todoListId,t.id,{status:n}))}),[e,t.id,t.todoListId]),o=Object(n.useCallback)((function(a){e(lt(t.todoListId,t.id,{title:a}))}),[e,t.id,t.todoListId]);return i.a.createElement("div",{className:t.status===c.Completed?"isDone":""},i.a.createElement(Et.a,{checked:t.status===c.Completed,onChange:a,color:"secondary",disabled:"loading"===t.entityStatus}),i.a.createElement(bt,{title:t.title,changeTitle:o,disabled:"loading"===t.entityStatus}),i.a.createElement(f.a,{onClick:function(){e(ct(t.todoListId,t.id))},disabled:"loading"===t.entityStatus},i.a.createElement(gt.a,null)))})),yt=i.a.memo((function(t){var e=Object(E.c)((function(e){return e.todoLists.filter((function(e){return e.id===t.id}))[0]})),a=Object(E.c)((function(e){return e.tasks[t.id]})),o=Object(E.b)();Object(n.useEffect)((function(){var e;o((e=t.id,function(t){t(B({status:"loading"})),L(e).then((function(a){t(ot({todoListId:e,tasks:a.data.items})),t(B({status:"succeeded"}))})).catch((function(e){z(e,t)}))}))}),[]);var r=a,l=r;"active"===t.filter?l=r.filter((function(t){return t.status!==c.Completed})):"completed"===t.filter&&(l=r.filter((function(t){return t.status===c.Completed})));var s=Object(n.useCallback)((function(t){o(function(t,e){return function(a){a(B({status:"loading"})),A(t,e).then((function(t){0===t.data.resultCode?(a(nt({task:t.data.data.item})),a(B({status:"succeeded"}))):P(t.data,a)})).catch((function(t){z(t,a)}))}}(e.id,t))}),[o]),u=Object(n.useCallback)((function(t){o(function(t,e){return function(a){a(B({status:"loading"})),C(t,e).then((function(n){0===n.data.resultCode?(a($({title:e,id:t})),a(B({status:"succeeded"}))):P(n.data,a)})).catch((function(t){z(t,a)}))}}(e.id,t))}),[o]),d=Object(n.useCallback)((function(){var t;o((t=e.id,function(e){e(B({status:"loading"})),e(Q({id:t,entityStatus:"loading"})),j(t).then((function(a){0===a.data.resultCode?(e(J({todolistId:t})),e(B({status:"succeeded"}))):P(a.data,e)})).catch((function(t){z(t,e)}))}))}),[o]);return i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(bt,{title:e.title,changeTitle:u}),i.a.createElement(f.a,{onClick:d,disabled:"loading"===t.entityStatus},i.a.createElement(gt.a,null))),i.a.createElement(pt,{createItem:s,disabled:"loading"===t.entityStatus}),i.a.createElement("div",null,l.map((function(e){return i.a.createElement(ht,{key:e.id,id:e.id,todoListId:t.id,title:e.title,status:e.status,entityStatus:e.entityStatus})}))),i.a.createElement("div",null,i.a.createElement(m.a,{color:"all"===e.filter?"primary":"default",variant:"contained",size:"small",onClick:function(){o(G({id:e.id,newValue:"all"}))}},"All"),i.a.createElement(m.a,{color:"active"===e.filter?"primary":"default",variant:"contained",size:"small",onClick:function(){o(G({id:e.id,newValue:"active"}))}},"Active"),i.a.createElement(m.a,{color:"completed"===e.filter?"primary":"default",variant:"contained",size:"small",onClick:function(){o(G({id:e.id,newValue:"completed"}))}},"Completed")))})),vt=a(13),Ct=function(){var t=Object(E.c)((function(t){return t.auth.isLoggedIn})),e=Object(E.c)((function(t){return t.todoLists})),a=(Object(E.c)((function(t){return t.tasks})),Object(E.b)());Object(n.useEffect)((function(){t&&a((function(t){t(B({status:"loading"})),k().then((function(e){t(Y({todoLists:e.data})),t(B({status:"succeeded"}))})).catch((function(e){z(e,t)}))}))}),[]);var o=Object(n.useCallback)((function(t,e){a(ct(e,t))}),[a]),r=Object(n.useCallback)((function(t,e){a(G({id:e,newValue:t}))}),[a]),c=Object(n.useCallback)((function(t){a(function(t){return function(e){e(B({status:"loading"})),I(t).then((function(t){0===t.data.resultCode?(e(W({todoList:t.data.data.item})),e(B({status:"succeeded"}))):P(t.data,e)})).catch((function(t){z(t,e)}))}}(t))}),[a]);return t?i.a.createElement(i.a.Fragment,null,i.a.createElement(st.a,{container:!0,style:{padding:"30px 0"}},i.a.createElement(pt,{createItem:c})),i.a.createElement(st.a,{container:!0,spacing:4},e.map((function(t){return i.a.createElement(st.a,{item:!0,key:t.id},i.a.createElement(ut.a,{elevation:3,style:{padding:"25px"}},i.a.createElement(yt,{id:t.id,title:t.title,removeTask:o,changeFilter:r,filter:t.filter,entityStatus:t.entityStatus})))})))):i.a.createElement(vt.a,{to:"/login"})},kt=a(180),It=a(177);function jt(t){return i.a.createElement(It.a,Object.assign({elevation:6,variant:"filled"},t))}function Ot(){var t=Object(E.b)(),e=Object(E.c)((function(t){return t.app.error})),a=function(e,a){"clickaway"!==a&&t(U({error:null}))};return i.a.createElement(kt.a,{open:null!==e,autoHideDuration:6e3,onClose:a},i.a.createElement(jt,{onClose:a,severity:"error"},e))}var Lt=a(181),At=a(163),wt=a(169),St=a(182),Tt=a(87),xt=function(){var t=Object(E.c)((function(t){return t.auth.isLoggedIn})),e=Object(E.b)(),a=Object(Tt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<3&&(e.password="The password is too short"):e.password="Required",e},onSubmit:function(t){var n;a.resetForm(),e((n=t,function(t){t(B({status:"loading"})),S(n).then((function(e){0===e.data.resultCode?(t(M({value:!0})),t(B({status:"succeeded"}))):P(e.data,t)})).catch((function(e){z(e,t)}))}))}});return t?i.a.createElement(vt.a,{to:"/"}):i.a.createElement(st.a,{container:!0,justify:"center"},i.a.createElement(st.a,{item:!0,xs:4},i.a.createElement("form",{onSubmit:a.handleSubmit},i.a.createElement(Lt.a,null,i.a.createElement(At.a,null,i.a.createElement("p",null,"To log in get registered",i.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},"here")),i.a.createElement("p",null,"or use common test account credentials:"),i.a.createElement("p",null,"Email: free@samuraijs.com"),i.a.createElement("p",null,"Password: free")),i.a.createElement(wt.a,null,i.a.createElement(ft.a,Object.assign({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.touched.email&&a.errors.email?i.a.createElement("div",{style:{color:"red"}},a.errors.email):null,i.a.createElement(ft.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.touched.password&&a.errors.password?i.a.createElement("div",{style:{color:"red"}},a.errors.password):null,i.a.createElement(St.a,{label:"Remember me",control:i.a.createElement(Et.a,a.getFieldProps("rememberMe"))}),i.a.createElement(m.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))};var Pt=function(){var t=Object(E.c)((function(t){return t.app.status})),e=Object(E.c)((function(t){return t.app.isInitialized})),a=Object(E.c)((function(t){return t.auth.isLoggedIn})),o=Object(E.b)();return Object(n.useEffect)((function(){o((function(t){T().then((function(e){0===e.data.resultCode?t(M({value:!0})):P(e.data,t)})).catch((function(e){z(e,t)})).finally((function(){t(_({isInitialized:!0}))}))}))}),[]),e?i.a.createElement("div",{className:"App"},i.a.createElement(Ot,null),i.a.createElement(u.a,{position:"static"},i.a.createElement(d.a,null,i.a.createElement(f.a,{edge:"start",color:"inherit","aria-label":"menu"},i.a.createElement(g.a,null)),i.a.createElement(m.a,{color:"inherit"},"Login"),a?i.a.createElement(m.a,{onClick:function(){o((function(t){t(B({status:"loading"})),x().then((function(e){0===e.data.resultCode?(t(M({value:!1})),t(B({status:"succeeded"}))):P(e.data,t)})).catch((function(e){z(e,t)}))}))}},"LOG OUT"):null),"loading"===t&&i.a.createElement(p.a,null)),i.a.createElement(b.a,{fixed:!0},i.a.createElement(vt.d,null,i.a.createElement(vt.b,{path:"/login",render:function(){return i.a.createElement(xt,null)}}),i.a.createElement(vt.b,{exact:!0,path:"/",render:function(){return i.a.createElement(Ct,null)}}),i.a.createElement(vt.b,{exact:!0,path:"/todo_list_ts",render:function(){return i.a.createElement(Ct,null)}}),i.a.createElement(vt.b,{path:"/404",render:function(){return i.a.createElement("h1",null,"404: Page not found")}}),i.a.createElement(vt.b,{path:"*",render:function(){return i.a.createElement("h1",null,"404: Not found")}})))):i.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},i.a.createElement(s.a,null))},zt=a(19),Ft=a(46),Nt=Object(zt.c)({tasks:tt,todoLists:K,app:R,auth:D}),Dt=Object(F.a)({reducer:Nt,middleware:function(t){return t().prepend(Ft.a)}});window.store=Dt;var Mt=a(45);r.a.render(i.a.createElement(E.a,{store:Dt},i.a.createElement(Mt.a,null,i.a.createElement(Pt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},98:function(t,e,a){t.exports=a(128)}},[[98,1,2]]]);
//# sourceMappingURL=main.0d95df71.chunk.js.map